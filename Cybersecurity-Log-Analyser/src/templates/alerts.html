<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Real-Time Alerts | Cybersecurity Log Analyzer</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="/static/css/styles.css"/>
  <style>
    body {
      margin: 0;
      font-family: 'Roboto Mono', monospace;
      background-color: #0b1a26;
      color: #ffffff;
      overflow-x: hidden;
      animation: fadeUp 1s ease-in-out;
    }

    header {
      background-color: #06131f;
      padding: 20px 40px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid #00d9ff22;
    }

    header h1 {
      font-size: 24px;
      margin: 0;
      text-shadow: 0 0 8px #00ffe4;
    }

    nav button {
      background: none;
      border: 1px solid #00d9ff;
      color: #ffffff;
      margin-left: 20px;
      font-size: 14px;
      cursor: pointer;
      padding: 10px 20px;
      border-radius: 10px;
      transition: all 0.3s ease;
    }

    nav button.active {
      background-color: #00d9ff;
      color: #0b1a26;
      box-shadow: 0 4px 10px rgba(0, 217, 255, 0.5);
    }

    nav button:hover {
      background-color: #00a7cc;
      box-shadow: 0 4px 10px rgba(0, 217, 255, 0.8);
    }

    .container {
      padding: 60px 40px 40px;
      animation: fadeUp 1s ease-in-out;
    }

    h2 {
      font-size: 26px;
      margin-bottom: 30px;
      text-shadow: 0 0 10px #00ffe4;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .table-container {
      max-height: 500px;
      overflow-y: auto;
      border-radius: 12px;
      box-shadow: 0 0 20px rgba(0,0,0,0.5);
      background-color: #10222f;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .table-container:hover {
      transform: translateY(-5px);
      box-shadow: 0 0 25px rgba(0, 217, 255, 0.2);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      border-radius: 12px;
    }

    th, td {
      padding: 14px 18px;
      text-align: left;
    }

    th {
      background-color: #122f41;
      color: #00d9ff;
      text-transform: uppercase;
      font-size: 13px;
      position: sticky;
      top: 0;
      z-index: 1;
    }

    td {
      font-size: 15px;
      color: #dce3e8;
      border-top: 1px solid #1e3b50;
    }

    tr {
      transition: background-color 0.5s ease, box-shadow 0.5s ease;
    }

    tr:nth-child(odd) {
      background-color: #0f2738;
    }

    tr:hover {
      background-color: #113a4f;
      transition: background-color 0.3s ease;
    }

    .level-info {
      color: #00e5ff;
      font-weight: bold;
    }

    .level-warning {
      color: #ffc107;
      font-weight: bold;
    }

    .level-error {
      color: #f44336;
      font-weight: bold;
    }

    .level-alert, .level-aert {
      color: #f06292;
      font-weight: bold;
    }

    .footer {
      text-align: center;
      padding: 20px;
      font-size: 14px;
      color: #78909c;
      border-top: 1px solid #1e3b50;
      margin-top: 60px;
      background-color: #0a1824;
      position: relative;
      bottom: 0;
      width: 100%;
      box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.3);
    }

    .new-log {
      animation: glowFade 3s ease-in-out;
      background-color: rgba(0, 255, 255, 0.1);
      box-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
    }

    @keyframes glowFade {
      0% {
        background-color: rgba(0, 255, 255, 0.2);
        box-shadow: 0 0 15px rgba(0, 255, 255, 0.8);
      }
      50% {
        background-color: rgba(0, 255, 255, 0.1);
        box-shadow: 0 0 8px rgba(0, 255, 255, 0.4);
      }
      100% {
        background-color: transparent;
        box-shadow: none;
      }
    }

    @keyframes fadeUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .alert-prefix {
      color: #ff4d4d;
      font-weight: bold;
      text-shadow: 0 0 5px #ff4d4d, 0 0 10px #ff0000;
      animation: alert-glow 1s infinite alternate;
    }

    @keyframes alert-glow {
      from {
        text-shadow: 0 0 5px #ff4d4d, 0 0 10px #ff0000;
      }
      to {
        text-shadow: 0 0 10px #ff4d4d, 0 0 20px #ff0000;
      }
    }
        /* === Fade Up Animation === */
        @keyframes fadeUp {
      0% {
        opacity: 0;
        transform: translateY(30px);
      }
      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .fade-up {
      opacity: 0;
      animation: fadeUp 0.8s ease-out forwards;
    }
    header h1 {
      margin: 0;
      font-size: 22px;
      color: #00d9ff;
      letter-spacing: 1px;
    }

    nav a {
      color: #00d9ff;
      text-decoration: none;
      margin-left: 20px;
      font-weight: bold;
      padding: 6px 12px;
      border-radius: 6px;
      transition: 0.3s ease;
    }

    nav a.active,
    nav a:hover {
      background-color: #00d9ff33;
    }
  </style>
</head>
<body>



  <header class="fade-up">
    <h1>Cybersecurity Log Analyzer</h1>
    <nav>
      <a href="/">Dashboard</a>
      <a href="/alerts" class="active">Alerts</a>
      <a href="/logs">Logs</a>

    </nav>
  </header>




  <main>
    <section id="alerts-section" class="fade-in">
      <h2>ðŸš¨ Live Threat Alerts</h2>
      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>Timestamp</th>
              <th>Alert Message</th>
            </tr>
          </thead>
          <tbody id="alerts-table-body">
            <!-- Alerts will be dynamically added here -->
          </tbody>
        </table>
      </div>
    </section>
  </main>

  <footer class="fade-in footer">
    <p>&copy; 2025 Cybersecurity Log Analyzer | Protecting Systems in Real-Time</p>
  </footer>

  <script>
    let seenAlerts = new Set();

    async function fetchAlerts() {
      try {
        const response = await fetch('/get_alerts');
        if (!response.ok) throw new Error("Failed to fetch alerts.");

        const alerts = await response.json();
        const tableBody = document.getElementById('alerts-table-body');

        alerts.reverse().forEach(alert => {
          const alertKey = `${alert.timestamp}-${alert.message}`;
          if (!seenAlerts.has(alertKey)) {
            seenAlerts.add(alertKey);

            let alertParts = alert.message.split('] ');
            let highlightedMessage = '';

            if (alertParts.length > 1 && alertParts[0].startsWith('[ALERT')) {
              let prefix = alertParts[0] + ']';
              let suffix = alertParts.slice(1).join('] ');
              highlightedMessage = `<span class="alert-prefix">${prefix}</span> ${suffix}`;
            } else {
              highlightedMessage = alert.message;
            }

            const row = document.createElement('tr');
            row.innerHTML = `
              <td>${alert.timestamp}</td>
              <td>${highlightedMessage}</td>
            `;
            row.classList.add("new-log");
            tableBody.prepend(row);
          }
        });
      } catch (error) {
        console.error("Error fetching alerts:", error);
      }
    }

    setInterval(fetchAlerts, 5000);
    fetchAlerts();
  </script>
</body>
</html>
